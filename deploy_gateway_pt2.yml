---
- name: Inicia Deploy Gateway  # Nome do playbook
  hosts: "{{ host_awx }}"  # Define os hosts de destino
  become: yes  # Tornar-se root durante a execução do playbook
  become_user: root  # Define o usuário para se tornar (root)
  become_method: sudo  # Define o metodo de se tornar como sudo
  gather_facts: yes  # Coletar fatos sobre os hosts de destino
  tasks:  # Lista de tarefas a serem executadas
    
    # Registra uma mensagem indicando a adição do usuário ao grupo Docker
    - name: Log Message Iniciando deploy  
      shell: echo  "\033[32m####_ADICIONANDO_USUARIO_AO_GRUPO_DOCKER####\033[0m" >> /var/log/ansible_deploy_logs/deploy_log.txt 2>&1
    
    # Adiciona o usuário ao grupo Docker
    - name: Adiciona o usuário ao grupo Docker  
      user:
        name: "{{ ansible_user }}"
        groups: docker
        append: yes
      become: yes
      notify:
        - Log Message
    # Pausa por 1 segundo
    - name: Espera 1 segundos  
      pause:
        seconds: 1
      notify:
        - Log Message
        
    # Registra uma mensagem indicando a verificação da versão do .NET
    - name: Log Message escreve no arquivo echo versao do dotnet
      shell: echo  "\033[32m####_VERSAO_DOTNET_####\033[0m" >> /var/log/ansible_deploy_logs/deploy_log.txt 2>&1

    - name: Log Message echo versao do dotnet
      shell: dotnet --version >> /var/log/ansible_deploy_logs/deploy_log.txt 2>&1